from ultralytics import RTDETR

# Load a pretrained model
model = RTDETR(r'C:\Users\kmhyt\Documents\GitHub\P7\yolov7\kaggle_2t4.pt')

# Run inference on 'bus.jpg' with arguments
results = model.predict(r'C:\Users\kmhyt\Documents\GitHub\P7\yolov7\fsoco_yolo\images\val\ulm_00002.jpg', save=False, imgsz=640, conf=0.5)

# View results
for r in results:
    print(r.boxes.cls) # Classes
# # Output
# tensor([3., 3., 1., 1., 1., 0., 1.], device='cuda:0')
    print(r.boxes)
# # Output
#     ultralytics.engine.results.Boxes object with attributes:

# cls: tensor([3., 3., 1., 1., 1., 0., 1.], device='cuda:0')
# conf: tensor([0.9404, 0.9601, 0.9482, 0.9219, 0.9049, 0.8954, 0.7341], device='cuda:0')
# data: tensor([[6.0957e+02, 3.9953e+02, 6.6585e+02, 4.6852e+02, 9.4038e-01, 3.0000e+00],
#         [6.8599e+02, 5.1933e+02, 7.6704e+02, 6.3901e+02, 9.6006e-01, 3.0000e+00],
#         [9.5377e+02, 4.1824e+02, 1.0072e+03, 4.8909e+02, 9.4817e-01, 1.0000e+00],
#         [8.9854e+02, 3.6282e+02, 9.3891e+02, 4.1047e+02, 9.2190e-01, 1.0000e+00],
#         [5.7676e+02, 3.1906e+02, 6.0341e+02, 3.5142e+02, 9.0494e-01, 1.0000e+00],
#         [8.8200e+02, 3.3403e+02, 9.0797e+02, 3.6798e+02, 8.9544e-01, 0.0000e+00],
#         [1.4853e+02, 2.4005e+02, 1.9364e+02, 2.8737e+02, 7.3411e-01, 1.0000e+00]], device='cuda:0')
# id: None
# is_track: False
# orig_shape: (1000, 1552)
# shape: torch.Size([7, 6])
# xywh: tensor([[637.7129, 434.0247,  56.2812,  68.9863],
#         [726.5109, 579.1725,  81.0514, 119.6842],
#         [980.4775, 453.6673,  53.4097,  70.8548],
#         [918.7231, 386.6455,  40.3690,  47.6495],
#         [590.0850, 335.2427,  26.6537,  32.3568],
#         [894.9833, 351.0050,  25.9699,  33.9419],
#         [171.0835, 263.7096,  45.1060,  47.3178]], device='cuda:0')
# xywhn: tensor([[0.4109, 0.4340, 0.0363, 0.0690],
#         [0.4681, 0.5792, 0.0522, 0.1197],
#         [0.6318, 0.4537, 0.0344, 0.0709],
#         [0.5920, 0.3866, 0.0260, 0.0476],
#         [0.3802, 0.3352, 0.0172, 0.0324],
#         [0.5767, 0.3510, 0.0167, 0.0339],
#         [0.1102, 0.2637, 0.0291, 0.0473]], device='cuda:0')
# xyxy: tensor([[ 609.5723,  399.5315,  665.8535,  468.5178],
#         [ 685.9852,  519.3304,  767.0366,  639.0146],
#         [ 953.7727,  418.2399, 1007.1824,  489.0947],
#         [ 898.5386,  362.8207,  938.9077,  410.4702],
#         [ 576.7581,  319.0643,  603.4118,  351.4211],
#         [ 881.9984,  334.0341,  907.9683,  367.9759],
#         [ 148.5305,  240.0507,  193.6366,  287.3685]], device='cuda:0')
# xyxyn: tensor([[0.3928, 0.3995, 0.4290, 0.4685],
#         [0.4420, 0.5193, 0.4942, 0.6390],
#         [0.6145, 0.4182, 0.6490, 0.4891],
#         [0.5790, 0.3628, 0.6050, 0.4105],
#         [0.3716, 0.3191, 0.3888, 0.3514],
#         [0.5683, 0.3340, 0.5850, 0.3680],
#         [0.0957, 0.2401, 0.1248, 0.2874]], device='cuda:0')